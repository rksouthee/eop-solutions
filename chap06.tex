\chapter{Iterators}

\begin{lemma}
	$0 \leq j \leq i \wedge \func{weak\_range}(f, i) \Rightarrow \func{weak\_range}(f, j)$
\end{lemma}

\begin{proof}
	$(0 \leq k \leq j) \Rightarrow \func{successor}^k(f) \text{ is defined.}$
\end{proof}

\begin{lemma}
	$(f + n) + m = f + (n + m)$
\end{lemma}

\begin{proof}
	\begin{align*}
		f + 0 &= f\\
		f + \func{successor}(n) &= \func{successor}(\func{successor}^n(f))
	\end{align*}
\end{proof}

\begin{lemma}
	\verb|successor| is defined for every iterator in a half-open range and for every iterator
	except the last in a closed range.
\end{lemma}

\begin{lemma}
	If $i \in [f, l)$, both $[f, i)$ and $[i, l)$ are bounded ranges.
\end{lemma}

\begin{proof}
	The range $[f, l)$ is partitioned into two disjoint sets by $i$.
\end{proof}

\begin{lemma}
	$i \notin \llbracket i, 0 \rrparenthesis \wedge [i, i)$
\end{lemma}

\begin{proof}
	Both ranges define an empty range, and have no elements in the set of iterators therefore
	no element can be a member of an empty set.
\end{proof}

\begin{lemma}
	Empty ranges have neither first nor last elements.
\end{lemma}

\begin{proof}
	By Lemma 6.5 empty ranges have no elements, and therefore have no first nor last element.
\end{proof}

\begin{lemma}
	The size of a half-open weak range $\llbracket f, n \rrparenthesis$ is $n$. The size of a
	closed weak range $\llbracket f, n \rrbracket$ is $n + 1$. The size of a half-open bounded
	range $[f, l)$ is $l - f$. The size of a closed bounded range $[f, l]$ is $(l - f) + 1$.
\end{lemma}

\begin{exercise}
	Use \verb|find_if| and \verb|find_if_not| to implement quantifier functions \verb|all|,
	\verb|none|, \verb|not_all|, and \verb|some|, each taking a bounded range and a predicate.
\end{exercise}

\lstinputlisting[language=c++, firstline=1491, lastline=1525]{eop-code/eop.h}

\begin{exercise}
	Implement \verb|count_if| by passing an appropriate function object to \verb|for_each|
	and extracting the accumulation result from the returned function object.
\end{exercise}

\lstinputlisting[language=c++, firstline=1544, lastline=1562]{eop-code/eop.h}

\begin{exercise}
	Implement variations taking a weak range instead of a bounded range of all the versions
	of \verb|find|, quantifiers, \verb|count|, and \verb|reduce|.
\end{exercise}

\lstinputlisting[language=c++, firstline=1782, lastline=1959]{eop-code/eop.h}
