\chapter{Coordinate Structures}

\begin{lemma}
	$\func{height\_recursive}(x) \leq \func{weight\_recursive}(x)$
\end{lemma}

\begin{proof}
	In the case that $x$ is empty we have
	\[ \func{height\_recursive}(x) = \func{weight\_recursive}(x) = 0. \]
	For the case when $x$ is non-empty we just need to show that
	$\func{max}(l, r) \leq l + r$. If $l = \func{max}(l, r)$ then we have
	\[ l \leq l + r, \]
	otherwise, if $\func{max}(l, r) = r$ we have
	\[ r \leq l + r. \]
\end{proof}

\begin{lemma}
	If $x$ and $y$ are bidirectional bifurcate coordinates,
	\begin{align*}
		\func{left\_successor}(x) = \func{left\_successor}(y) &\Rightarrow x = y\\
		\func{left\_successor}(x) = \func{right\_successor}(y) &\Rightarrow x = y\\
		\func{right\_successor}(x) = \func{right\_successor}(y) &\Rightarrow x = y
	\end{align*}
\end{lemma}

\begin{proof}
	Using the regularity of \verb|predecessor| we have
	\begin{align*}
		\func{predecessor}(\func{left\_successor}(x)) &= \func{predecessor}(\func{right\_successor}(x)) = x\\
		\func{predecessor}(\func{left\_successor}(y)) &= \func{predecessor}(\func{right\_successor}(y)) = y
	\end{align*}
\end{proof}

\begin{exercise}
	Would the existence of a coordinate $x$ such that
	\[ \func{is\_left\_successor}(x) \wedge \func{is\_right\_successor}(x) \]
	contradict the axioms of bidirectional bifurcate coordinates?
\end{exercise}

\begin{solution}
	The existence of $x$ does not contradict the axioms of bidirectional bifurcate coordinates.
\end{solution}

\begin{lemma}
	If \verb|reachable| returns true, $v = \func{pre}$ right before the return.
\end{lemma}

\begin{exercise}
	Change \verb|weight| to count \verb|in| or \verb|post| visits instead of \verb|pre|.
\end{exercise}

\lstinputlisting[language=c++, firstline=2640, lastline=2672]{eop-code/eop.h}

\begin{exercise}
	Use \verb|traverse_step| and the procedures of Chapter 2 to determine whether the
	descendants of a bidirectional bifurcate coordinate form a DAG.
\end{exercise}

\lstinputlisting[language=c++, firstline=2715, lastline=2747]{eop-code/eop.h}
